id: FR-006
type: FR
title: Abort時の理由必須記録
role: 利用者（詳細TBD）
what: 利用者がタスクをAbortとする場合、Abort理由を必ず記録し、後から参照できること。
why: Abortを例外ではなく正式な品質判断として扱い、差し戻し理由や「今回対象外／前提未確定／スコープ外」等の判断根拠をログとして残すため。
acceptance_criteria:
- 利用者がタスクをAbortにする際、Abort理由が未入力の状態ではAbortとして確定できないこと。
- 記録されたAbort理由を、当該タスクを指定して後から参照できること。
- Abort理由が記録されていることを、タスクの状態（Abort）と紐づけて識別できること。
exceptions:
- Abort理由の入力制約（自由記述のみか、カテゴリ等を併用するか、最小文字数など）はTBD（企画書に明示なし）。
- Abort理由を入力できない状況（権限不足等）の扱いはTBD（Abortとして確定できないことが利用者に分かる結果が必要）。
logs:
- Abortへの変更と、Abort理由の記録の事実が後から追跡できること（記録粒度はTBD）。
dependencies:
- FR-005（タスクステータス管理：ToDo/Done/Abort）
- FR-007（Abortを正式な品質判断として扱う）
- AR-002（変更履歴の追跡：誰が/いつ/何を判断したかの最小記録）
permissions:
- 利用者がAbort理由を記録・参照できること。
nfr: []
evidence:
- 企画書「6. ステータス設計」「Abort設計思想」：Abortは理由必須でログ化し、正式な品質判断として扱う旨の記載。
- 既存要件（outputs/PR-001/RUN-001.md）：FR-006の記載（Abort理由必須、後から参照）。
- 診断（outputs/PR-002/RUN-001-re1.md）：FR-006の修正方針（理由の品質・参照性、ログ/証跡粒度の明確化が不足）。
changes_from_current:
- 既存要件（outputs/PR-001/RUN-001.md）の意図（Abort理由必須、参照可能）を維持した。
- 診断（outputs/PR-002/RUN-001-re1.md）の指摘に基づき、Abort理由の参照性とログ/証跡（変更と理由記録の追跡）を最小限追記した。
- DeepEvalで繰り返し指摘された「チェックリスト観点（例外/ログ/証跡、権限等）の不足」をTBDとして明示し、推測で確定しないよう整理した。
tbd:
- Abort理由の入力制約（自由記述のみか、カテゴリ等を併用するか、最小文字数など）。
- Abort理由をどの単位で参照できるか（例：タスク詳細、履歴など）の具体（Howではなく利用者にとっての観測可能な結果）。
- ロール定義（利用者/管理者/閲覧者等）と、ロールごとのAbort実行・理由閲覧の権限範囲。
- Abortおよび理由記録のログ/証跡の最小粒度（例：誰/いつ/どのタスクをAbortにし、理由を何にしたか）。
meta:
  run_id: FR-006
  prompt_id: PR-004
  timestamp: 2026-02-14 16:08
  model: gpt-5.2
  output_hash: 09a648a8b3e105306ea978ee057fc10c4a5746ad04efafeee4ffd6ee0654c591
