id: FR-009
type: FR
title: 品質フロー図生成（実施済タスク接続＋Abort分岐表示）
role: 利用者（詳細TBD）
what: タスク集合および各タスクの状態（ToDo／Done／Abort）と理由（Abort時）に基づき、実施済タスクのつながりとAbort分岐を含む品質フロー図として、プロジェクト固有の品質履歴を生成できること。
why: 上流QAの実施状況と判断ログを可視化し、進捗と品質保証範囲を把握可能にするため。
acceptance_criteria:
- Doneとなったタスクが、実施済タスクの連なりとして識別できる形で表示されること。
- Abortとなったタスクが、分岐として識別でき、当該分岐のAbort理由を参照できること。
- どのプロジェクト（または作業単位）の品質履歴であるかが識別できること（詳細はTBD）。
exceptions:
- タスクの接続（順序関係）の定義（順序が固定か任意か等）はTBD。
- 対象タスクが存在しない場合や、可視化できない状態の場合の扱いはTBD（利用者に分かる結果が必要）。
logs:
- 品質フロー図が生成された事実と、対象（プロジェクト/スナップショット等）が後から追跡できること（記録粒度はTBD）。
dependencies:
- FR-008（実施ステータスの記録）
- FR-006（Abort時の理由必須記録）
- AR-001（プロジェクト/作業単位の識別と紐づけ）
permissions:
- 利用者が品質フロー図を参照できること。
nfr: []
evidence:
- 企画書「7. 可視化機能」：実施済タスクを接続し、Abort分岐も表示し、品質履歴を生成する旨の記載。
- 企画書「1. 企画背景」：進捗と品質保証範囲が可視化されないという課題の記載。
- 既存要件（outputs/PR-001/RUN-001.md）：FR-009の記載（Done接続＋Abort分岐表示のフロー図生成）。
- 診断（outputs/PR-002/RUN-001-re1.md）：FR-009の修正方針（受入基準が抽象で、最小ACの具体化が必要）。
changes_from_current:
- 既存要件（outputs/PR-001/RUN-001.md）の意図（品質フロー図の生成、Abort分岐表示）を維持した。
- 診断（outputs/PR-002/RUN-001-re1.md）の指摘に基づき、受入基準（何が識別できれば合格か）を最小限具体化した。
- DeepEvalで繰り返し指摘された「チェックリスト観点（例外/ログ/証跡、依存、ロール等）の不足」をTBDとして明示し、推測で確定しないよう整理した。
tbd:
- タスク接続の定義（順序関係の扱い、接続ルール）。
- プロジェクト/作業単位と品質履歴（フロー図）の紐づけ方（観測可能な結果としての識別の仕方）。
- ロール定義（利用者/管理者/閲覧者等）と、ロールごとの参照権限。
- フロー図生成・参照のログ/証跡の最小粒度（例：誰/いつ/どの履歴を生成・参照したか）。
meta:
  run_id: FR-009
  prompt_id: PR-004
  timestamp: 2026-02-14 16:14
  model: gpt-5.2
  output_hash: 63de11b1f33bb2a9f0677eee477349c91f49dd533053731f9ce77856548ea15c
